---
title:  "JPA & Hibernate Proxy"

categories:
- jpa
  tags:
- jpa
- study
- proxy
  last_modified_at: 2021-05-06T00:40:00-00:00
---

# JPA Proxy
RDB 와 다르게 java에서는 참조를 통해 객체의 주소값을 가지고 oneToMany의 경우 전체의 List를 가질 수 있다.   
성능적인 이슈를 생각해 볼 수 있는데 Member와 Order 관계를 예를 들어 보겠다.   
```java
@Entity
public class Member {
    @Id @GeneratedValue
    private Long id;

    private String name;

    @OneToMany(mappedBy = "member", cascade = CascadeType.ALL, orphanRemoval = true)
    private Set<Orders> orders = new HashSet<>();

    // 연관관계 편의 메소드
    public void addOrder(Orders orderB) {
        this.orders.add(orderB);
        orderB.setMember(this);
    }
    ••• //getter setter
}
@Entity
public class Orders {
    @Id @GeneratedValue
    private Long id;

    private LocalDateTime orderDate;

    @ManyToOne(fetch = FetchType.LAZY)
    @JoinColumn(name = "MEMBER_ID")
    private Member member;
    
    ••• //getter setter
}
```
만약 Member가 주문을 1만번 했다고 했을 때 Member객체 조회에 orders가 1만개나 들어 있어야 한다면 성능적으로 엄청 안좋은 이슈가 된다.   
(꼭 Order만 아니라 연관된 여러 엔티티를 Member조회 시점에 다 부르는 건 좋지 않다.)   
이에 jpa & hibernate는 proxy를 사용하여 객체를 감싸고 그 객체에서 참조값이 실제로 사용될 때 영속성 컨텍스트 or DB 조회하여 불러온다.


